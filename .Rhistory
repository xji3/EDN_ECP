source('~/.active-rstudio-document', echo=TRUE)
rm(list=ls())  # clean up workspace
path <- "/Users/xji3/GitFolders/EDN_ECP/MG94"
summary.list <- c("_clock_summary",
"_nonclock_summary",
"_Force_clock_summary",
"_Force_nonclock_summary"
)
pair = ["EDN", "ECP"]
for (target.summary in summary.list){
summary_file <- paste(path, "_EDN_ECP", target.summary, '.txt', sep = '')
rm(list=ls())  # clean up workspace
path <- "/Users/xji3/GitFolders/EDN_ECP/MG94"
)
rm(list=ls())  # clean up workspace
path <- "/Users/xji3/GitFolders/EDN_ECP/MG94"
summary.list <- c("_clock_summary",
"_nonclock_summary",
"_Force_clock_summary",
"_Force_nonclock_summary"
)
pair = c("EDN", "ECP")
for (target.summary in summary.list){
summary_file <- paste(path, "_EDN_ECP", target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(target.summary, summary_mat)
}
rm(list=ls())  # clean up workspace
path <- "/Users/xji3/GitFolders/EDN_ECP/Summary/MG94"
summary.list <- c("_clock_summary",
"_nonclock_summary",
"_Force_clock_summary",
"_Force_nonclock_summary"
)
pair = c("EDN", "ECP")
for (target.summary in summary.list){
summary_file <- paste(path, "_EDN_ECP", target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(target.summary, summary_mat)
}
row.names
for (target.summary in summary.list){
summary_file <- paste(path, "_EDN_ECP", target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
print(row.names)
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(target.summary, summary_mat)
}
target.summary
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
col.names
summary_file <- paste(path, "_EDN_ECP", target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
print(row.names)
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names))
assign(target.summary, summary_mat)
summary_mat
summary_file <- paste(path, "_EDN_ECP", target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
col.name <- paste("MG94", target.summary, sep = "")
print(row.names)
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.name))
assign(target.summary, summary_mat)
View(summary_mat)
col.name <- paste("MG94_EDN_ECP", target.summary, sep = "")
print(row.names)
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.name))
assign(target.summary, summary_mat)
View(summary_mat)
rm(list=ls())  # clean up workspace
path <- "/Users/xji3/GitFolders/EDN_ECP/Summary/MG94"
summary.list <- c("_clock_summary",
"_nonclock_summary",
"_Force_clock_summary",
"_Force_nonclock_summary"
)
pair = c("EDN", "ECP")
for (target.summary in summary.list){
summary_file <- paste(path, "_EDN_ECP", target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
col.name <- paste("MG94_EDN_ECP", target.summary, sep = "")
print(row.names)
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.name))
assign(target.summary, summary_mat)
}
rm(list=ls())  # clean up workspace
path <- "/Users/xji3/GitFolders/EDN_ECP/Summary/MG94"
summary.list <- c("_clock_summary",
"_nonclock_summary",
"_Force_clock_summary",
"_Force_nonclock_summary"
)
pair = c("EDN", "ECP")
for (target.summary in summary.list){
summary_file <- paste(path, "_EDN_ECP", target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
col.name <- paste("MG94_EDN_ECP", target.summary, sep = "")
print(row.names)
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.name))
assign(target.summary, summary_mat)
}
rm(list=ls())  # clean up workspace
path <- "/Users/xji3/GitFolders/EDN_ECP/Summary/MG94"
summary.list <- c("_clock_summary",
"_nonclock_summary",
"_Force_clock_summary",
"_Force_nonclock_summary"
)
pair = c("EDN", "ECP")
for (target.summary in summary.list){
summary_file <- paste(path, "_EDN_ECP", target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
col.name <- paste("MG94_EDN_ECP", target.summary, sep = "")
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.name))
assign(target.summary, summary_mat)
}
rm(list=ls())  # clean up workspace
path <- "/Users/xji3/GitFolders/EDN_ECP/Summary/MG94"
summary.list <- c("_clock_summary",
"_nonclock_summary",
"_Force_clock_summary",
"_Force_nonclock_summary"
)
pair = c("EDN", "ECP")
for (target.summary in summary.list){
summary_file <- paste(path, "_EDN_ECP", target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
col.name <- paste("MG94_EDN_ECP", target.summary, sep = "")
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.name))
assign(paste("MG94", target.summary, sep = ""), summary_mat)
}
rm(list=ls())  # clean up workspace
path <- "/Users/xji3/GitFolders/EDN_ECP/Summary/MG94"
summary.list <- c("_clock_summary",
"_nonclock_summary",
"_Force_clock_summary",
"_Force_nonclock_summary"
)
pair = c("EDN", "ECP")
for (target.summary in summary.list){
summary_file <- paste(path, "_EDN_ECP", target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
col.name <- paste("MG94_EDN_ECP", target.summary, sep = "")
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.name))
assign(paste("MG94", target.summary, sep = ""), summary_mat)
}
ECP.EDN.MG94 <- cbind(MG94_nonclock_summary, MG94_clock_summary,
MG94_Force_nonclock_summary, MG94_Force_clock_summary)
ECP.EDN.MG94
View(ECP.EDN.MG94)
ECP.EDN.MG94[18:25, ]/ECP.EDN.MG94[42:49, ]
colSums(ECP.EDN.MG94[18:25, ])/colSums(ECP.EDN.MG94[42:49, ])
ECP.EDN.MG94[18:25, ]/(ECP.EDN.MG94[42:49, ] + ECP.EDN.MG94[18:25, ])
colSums(ECP.EDN.MG94[18:25, ])/colSums(ECP.EDN.MG94[42:49, ] + ECP.EDN.MG94[18:25, ])
# plot one paralog
paralog = "EDN_ECP"
lnL.ratio <- as.vector(read.table(paste("./summary/", paralog, "_MG94_nonclock_HMM_log_posterior_ratio.txt", sep = "")))
Viterbi.path <- as.vector(read.table(paste("./summary/", paralog, "_MG94_nonclock_HMM_Viterbi_path.txt", sep = "")))
lnL.surface <- as.vector(read.table(paste("./summary/", paralog, "_MG94_nonclock_HMM_lnL_surface.txt", sep = "")))
IGC.sw.lnL <- as.vector(read.table(paste("./summary/", paralog, "_MG94_nonclock_sw_lnL.txt", sep = "")))
Force.sw.lnL <- as.vector(read.table(paste("./summary/Force_", paralog, "_MG94_nonclock_sw_lnL.txt", sep = "")))
plot(lnL.ratio[, 1], xlab = "codon number", ylab = "log values",
type = "l", col = "black", lty = 1,
main = paste(paralog, " HMM result"),
ylim = c(min(-0.5, min(lnL.ratio)), max(lnL.ratio)))
lines(1:dim(Viterbi.path)[1], Viterbi.path[, 1], type = "S", lty = 2, col = "red")
#lines(1:dim(IGC.sw.lnL)[1], IGC.sw.lnL[, 2] - Force.sw.lnL[, 2], type = "l", lty = 3, col = "red")
legend(1, max(lnL.ratio), legend = c("log posterior ratio", "Viterbi path"),
lty = c(1, 2), col = c( "black", "red"))
plot(-lnL.surface[, 1], xlab = "tract length in nucleotide", ylab= "lnL", type = "l", col = "black", lty = 1,
main = paste(paralog, " lnL surface"))
# plot one paralog
paralog = "EDN_ECP"
lnL.ratio <- as.vector(read.table(paste("./summary/", paralog, "_MG94_nonclock_HMM_log_posterior_ratio.txt", sep = "")))
Viterbi.path <- as.vector(read.table(paste("./summary/", paralog, "_MG94_nonclock_HMM_Viterbi_path.txt", sep = "")))
lnL.surface <- as.vector(read.table(paste("./summary/", paralog, "_MG94_nonclock_HMM_lnL_surface.txt", sep = "")))
IGC.sw.lnL <- as.vector(read.table(paste("./summary/", paralog, "_MG94_nonclock_sw_lnL.txt", sep = "")))
Force.sw.lnL <- as.vector(read.table(paste("./summary/Force_", paralog, "_MG94_nonclock_sw_lnL.txt", sep = "")))
plot(lnL.ratio[, 1], xlab = "codon number", ylab = "log values",
type = "l", col = "black", lty = 1,
main = paste(paralog, " HMM result"),
ylim = c(min(-0.5, min(lnL.ratio)), max(lnL.ratio)))
lines(1:dim(Viterbi.path)[1], Viterbi.path[, 1], type = "S", lty = 2, col = "red")
#lines(1:dim(IGC.sw.lnL)[1], IGC.sw.lnL[, 2] - Force.sw.lnL[, 2], type = "l", lty = 3, col = "red")
legend(1, max(lnL.ratio), legend = c("log posterior ratio", "Viterbi path"),
lty = c(1, 2), col = c( "black", "red"))
plot(-lnL.surface[, 1], xlab = "tract length in nucleotide", ylab= "lnL", type = "l", col = "black", lty = 1,
main = paste(paralog, " lnL surface"))
summary.mat <- read.table("./HMM_tract_MG94_nonclock_summary.txt")
# Now calculate standard deviation of lnP
lnP <- log(3.0 / summary.mat[, 3])
sd.lnP <- 1.0 / sqrt(-summary.mat[, 7])
low.cf <- exp(lnP - 1.96 * sd.lnP)
up.cf  <- exp(lnP + 1.96 * sd.lnP)
up.cf[up.cf > 1] <- 1.0
summary.mat <- cbind(summary.mat, 3.0 / up.cf, 3.0 / low.cf)
rownames(summary.mat) <- c("EDN_ECP")
colnames(summary.mat) <- c("lnL", "max lnL", "tract length",
"Pr(S_0)", "Pr(S_1)",
"df", "d^2f", "c.i. tract length", "c.i tract length")
summary.mat
source('~/.active-rstudio-document', echo=TRUE)
# plot one paralog
paralog = "EDN_ECP"
lnL.ratio <- as.vector(read.table(paste("./summary/", paralog, "_MG94_nonclock_HMM_log_posterior_ratio.txt", sep = "")))
Viterbi.path <- as.vector(read.table(paste("./summary/", paralog, "_MG94_nonclock_HMM_Viterbi_path.txt", sep = "")))
lnL.surface <- as.vector(read.table(paste("./summary/", paralog, "_MG94_nonclock_HMM_lnL_surface.txt", sep = "")))
IGC.sw.lnL <- as.vector(read.table(paste("./summary/", paralog, "_MG94_nonclock_sw_lnL.txt", sep = "")))
Force.sw.lnL <- as.vector(read.table(paste("./summary/Force_", paralog, "_MG94_nonclock_sw_lnL.txt", sep = "")))
plot(lnL.ratio[, 1], xlab = "codon number", ylab = "log values",
type = "l", col = "black", lty = 1,
main = paste(paralog, " HMM result"),
ylim = c(min(-0.5, min(lnL.ratio)), max(lnL.ratio)))
lines(1:dim(Viterbi.path)[1], Viterbi.path[, 1], type = "S", lty = 2, col = "red")
#lines(1:dim(IGC.sw.lnL)[1], IGC.sw.lnL[, 2] - Force.sw.lnL[, 2], type = "l", lty = 3, col = "red")
legend(1, max(lnL.ratio), legend = c("log posterior ratio", "Viterbi path"),
lty = c(1, 2), col = c( "black", "red"))
plot(-lnL.surface[, 1], xlab = "tract length in nucleotide", ylab= "lnL", type = "l", col = "black", lty = 1,
main = paste(paralog, " lnL surface"))
summary.mat <- read.table("./HMM_tract_MG94_nonclock_summary.txt")
# Now calculate standard deviation of lnP
lnP <- log(3.0 / summary.mat[, 3])
sd.lnP <- 1.0 / sqrt(-summary.mat[, 7])
low.cf <- exp(lnP - 1.96 * sd.lnP)
up.cf  <- exp(lnP + 1.96 * sd.lnP)
up.cf[up.cf > 1] <- 1.0
summary.mat <- cbind(summary.mat, 3.0 / up.cf, 3.0 / low.cf)
rownames(summary.mat) <- c("EDN_ECP")
colnames(summary.mat) <- c("lnL", "max lnL", "tract length",
"Pr(S_0)", "Pr(S_1)",
"df", "d^2f", "c.i. tract length", "c.i tract length")
summary.mat
